(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["onlyOffice"],{"0adc":function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},n=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"report-onlyoffice"},[i("div",{attrs:{id:"placeholder"}})])}],c=i("5530"),r=(i("ac1f"),i("00b4"),i("d3b7"),i("7c54")),a={name:"OnlyOffice",data:function(){return{docEditor:null,platform:"desktop"}},computed:{fileInfo:function(){return this.$route.query}},created:function(){this.judgePlatform()},mounted:function(){var e=this;this.$nextTick((function(){switch(e.fileInfo.ot){case"add":e.initOnlyoffice();break;case"edit":e.editDoc();break;case"detail":e.showDocDetail();break}}))},destroyed:function(){this.docEditor.destroyEditor()},methods:{initOnlyoffice:function(){var e=this,t={userFileId:this.fileInfo.userFileId,fileId:this.fileInfo.fileId,fileName:this.fileInfo.fileName,filePath:this.fileInfo.filePath,fileCategory:this.fileInfo.fileCategory,type:this.fileInfo.type,memo:this.fileInfo.memo};Object(r["a"])(t).then((function(t){if(200===t.code){var i=Object(c["a"])(Object(c["a"])({},t.data.file),{},{type:e.platform});e.initDocEditor(t.data.docserviceApiUrl,i)}}))},initDocEditor:function(e,t){var i=this;this.loadOnlyOfficeAPI(e).then((function(){i.docEditor=new DocsAPI.DocEditor("placeholder",Object(c["a"])(Object(c["a"])({},t),{},{editorConfig:Object(c["a"])(Object(c["a"])({},t.editorConfig),{},{lang:"zh",customization:Object(c["a"])(Object(c["a"])({},t.editorConfig.customization),{},{zoom:100})})}))}))},judgePlatform:function(){if(this.platform="desktop",(/AppleWebKit.*Mobile/i.test(navigator.userAgent)||/MIDP|SymbianOS|NOKIA|SAMSUNG|LG|NEC|TCL|Alcatel|BIRD|DBTEL|Dopod|PHILIPS|HAIER|LENOVO|MOT-|Nokia|SonyEricsson|SIE-|Amoi|ZTE/.test(navigator.userAgent))&&window.location.href.indexOf("?mobile")<0)try{/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)&&(this.platform="mobile")}catch(e){console.log(e)}},showDocDetail:function(){var e=this,t={userFileId:this.fileInfo.userFileId,previewUrl:this.fileInfo.fileUrl};Object(r["c"])(t).then((function(t){if(200===t.code){var i=Object(c["a"])(Object(c["a"])({},t.data.file),{},{type:e.platform});i.document.permissions.edit=!1,e.initDocEditor(t.data.docserviceApiUrl,i)}}))},editDoc:function(){var e=this,t={userFileId:this.fileInfo.userFileId,previewUrl:this.fileInfo.fileUrl};Object(r["b"])(t).then((function(t){if(200===t.code){var i=Object(c["a"])(Object(c["a"])({},t.data.file),{},{type:e.platform});e.initDocEditor(t.data.docserviceApiUrl,i)}}))},loadOnlyOfficeAPI:function(e){return new Promise((function(t,i){var o=document.createElement("script");o.type="text/javascript",o.src=e,document.body.appendChild(o),o.onload=function(){t()},o.onerror=function(){i()}}))}}},f=a,l=(i("b50b"),i("2877")),d=Object(l["a"])(f,o,n,!1,null,"60fd980e",null);t["default"]=d.exports},b50b:function(e,t,i){"use strict";i("ed07")},ed07:function(e,t,i){}}]);